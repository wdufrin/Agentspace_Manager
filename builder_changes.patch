diff --git a/pages/AgentBuilderPage.tsx b/pages/AgentBuilderPage.tsx
index 3ab03a2..897cf8a 100644
--- a/pages/AgentBuilderPage.tsx
+++ b/pages/AgentBuilderPage.tsx
@@ -39,28 +39,15 @@ interface AdkAgentConfig {
     instruction: string;
     tools: AgentTool[];
     useGoogleSearch: boolean;
-    enableOAuth: boolean;
-    authId: string;
     enableDiscoveryApi: boolean;
     discoveryConfig: DiscoveryConfig;
-    enableCloudLogging: boolean;
-    enableCloudStorage: boolean;
-    enableTelemetry: boolean;
-    enableMessageLogging: boolean;
     enableBqAnalytics: boolean;
     bqDatasetId: string;
     bqTableId: string;
     enableThinking: boolean;
     thinkingBudget: number;
     enableStreaming: boolean;
-    enableMonitoring: boolean;
-    enableSecurityCenter: boolean;
-    enableRecommender: boolean;
-    enableServiceHealth: boolean;
-    enableNetworkManagement: boolean;
-    enableResourceDiscovery: boolean;
     enableBigQueryMcp: boolean;
-    enableEmailTool: boolean;
 }
 
 interface DiscoveryConfig {
@@ -467,7 +454,7 @@ echo "Your A2A function is now available at: $SERVICE_URL"
 
 // --- ADK Generators ---
 
-const generateAuthUtils = (): string => {
+const generateAuthPy = (): string => {
     return `import os
 import logging
 from typing import Optional
@@ -507,80 +494,10 @@ import google.auth
 import google.auth.transport.requests
 from typing import Optional, Dict, Any, List
 from google.adk.tools import ToolContext
-from auth_utils import get_user_credentials
 
 logger = logging.getLogger(__name__)
 `;
 
-    if (config.enableCloudLogging) {
-        code += `
-from google.cloud import logging as cloud_logging
-
-def read_recent_logs(tool_context: ToolContext, filter_str: str = "") -> str:
-    """
-    Reads the last 20 log entries from Cloud Logging.
-    
-    Args:
-        tool_context: The context provided by the ADK runtime.
-        filter_str: Optional filter string for the logs.
-    """
-    try:
-        creds = get_user_credentials(tool_context)
-        # fallback to default creds if not found (or let library handle it if None)
-        client = cloud_logging.Client(credentials=creds, project=os.environ["GOOGLE_CLOUD_PROJECT"])
-        
-        # Default simple filter if empty
-        if not filter_str:
-            filter_str = "severity>=WARNING"
-            
-        entries = client.list_entries(filter_=filter_str, page_size=20, max_results=20, order_by=cloud_logging.DESCENDING)
-        
-        logs = []
-        for entry in entries:
-            timestamp = entry.timestamp.isoformat() if entry.timestamp else "N/A"
-            payload = str(entry.payload) if entry.payload else "No Payload"
-            logs.append(f"[{timestamp}] {entry.severity}: {payload}")
-            
-        if not logs:
-            return "No logs found matching the filter."
-            
-        return "\\n".join(logs)
-    except Exception as e:
-        return f"Error reading logs: {e}"
-`;
-    }
-
-    if (config.enableCloudStorage) {
-        code += `
-from google.cloud import storage
-
-def list_gcs_buckets(tool_context: ToolContext) -> str:
-    """Lists all GCS buckets in the project."""
-    try:
-        creds = get_user_credentials(tool_context)
-        client = storage.Client(credentials=creds, project=os.environ["GOOGLE_CLOUD_PROJECT"])
-        buckets = list(client.list_buckets())
-        if not buckets:
-             return "No buckets found."
-        return "\\n".join([b.name for b in buckets])
-    except Exception as e:
-        return f"Error listing buckets: {e}"
-
-def list_gcs_objects(tool_context: ToolContext, bucket_name: str, prefix: str = "") -> str:
-    """Lists objects in a specific GCS bucket."""
-    try:
-        creds = get_user_credentials(tool_context)
-        client = storage.Client(credentials=creds, project=os.environ["GOOGLE_CLOUD_PROJECT"])
-        bucket = client.bucket(bucket_name)
-        blobs = list(client.list_blobs(bucket, prefix=prefix, max_results=50))
-        if not blobs:
-            return f"No objects found in {bucket_name} with prefix '{prefix}'."
-        return "\\n".join([b.name for b in blobs])
-    except Exception as e:
-        return f"Error listing objects: {e}"
-`;
-    }
-
     if (config.enableDiscoveryApi) {
         code += `
 def query_gemini_enterprise(tool_context: ToolContext, query_text: str) -> str:
@@ -604,33 +521,18 @@ def query_gemini_enterprise(tool_context: ToolContext, query_text: str) -> str:
     
     url = f"https://discoveryengine.googleapis.com/v1alpha/projects/{project_id}/locations/{location}/collections/{collection}/engines/{engine_id}/assistants/default_assistant:streamAssist"
     
-    # Get credentials
-    # 1. Try User Credentials from ToolContext (Agent Engine Identity Propagation)
-    creds = get_user_credentials(tool_context)
-    
-    # 2. Fallback to Service Account / ADC
-    if not creds:
-        logger.info("No user credentials found in context. Falling back to Application Default Credentials.")
-        scopes = ["https://www.googleapis.com/auth/cloud-platform"]
-        creds, _ = google.auth.default(scopes=scopes)
-
-    # Refresh if needed (for ADC; User creds from context usually are simple tokens but might need refresh if expired and we have refresh token - but simple Credentials wrapping token won't refresh)
-    # Actually, Credentials(token=...) is read-only. We rely on valid token.
-    if not creds.valid and creds.refresh_token:
-        auth_req = google.auth.transport.requests.Request()
-        creds.refresh(auth_req)
-    
-    # If we still don't have a valid token (e.g. user token expired and no refresh), we might fail.
-    # But for ADC, it handles refresh.
-    
+    # Try Service Account / ADC
+    scopes = ["https://www.googleapis.com/auth/cloud-platform"]
+    creds, _ = google.auth.default(scopes=scopes)
+
     # For now, just use the token property.
-    token = creds.token
+    token = getattr(creds, 'token', None)
     # If creds came from google.auth.default(), we definitely need to ensure it's refreshed.
     if not token:
         # Force refresh for ADC
          auth_req = google.auth.transport.requests.Request()
          creds.refresh(auth_req)
-         token = creds.token
+         token = getattr(creds, 'token', None)
     
     headers = {
         "Authorization": f"Bearer {token}",
@@ -758,14 +660,13 @@ def query_gemini_enterprise(tool_context: ToolContext, query_text: str) -> str:
              logger.warning("Failed to parse response as JSON. Returning raw text.")
              return f"Raw response:\\n{response.text}"
 
-    except Exception as e:
         logger.error(f"Error querying Gemini Enterprise: {e}")
         return f"Error: {str(e)}"
-`;
+\`;
     }
 
     if (config.tools.some(t => t.type === 'A2AClientTool')) {
-        code += `
+        code += \`
 import google.oauth2.id_token
 
 def create_a2a_tool(url: str, tool_name: str):
@@ -811,299 +712,6 @@ def create_a2a_tool(url: str, tool_name: str):
 `;
     }
 
-    if (config.enableMonitoring) {
-        code += `
-from google.cloud import monitoring_v3
-import time
-
-def check_health(tool_context: ToolContext, project_id: str = None) -> str:
-    """Checks the health of applications in the GCP project by listing alert policies."""
-    try:
-        project_id = project_id or os.getenv("GOOGLE_CLOUD_PROJECT")
-        credential = get_user_credentials(tool_context)
-        if not credential: return "Error: Authentication required."
-        client = monitoring_v3.AlertPolicyServiceClient(credentials=credential)
-        policies = client.list_alert_policies(request={"name": f"projects/{project_id}"})
-        active_policies = [f"- {p.display_name} (Enabled)" for p in policies if p.enabled]
-        return f"Alert Policies:\\n" + "\\n".join(active_policies) if active_policies else "No enabled alert policies."
-    except Exception as e:
-        return f"Error checking health: {str(e)}"
-
-def get_service_metrics(tool_context: ToolContext, service_name: str, metric_type: str = "cpu", duration_minutes: int = 60, project_id: str = None) -> str:
-    """Retrieves metrics for a specific Cloud Run service. metric_type can be cpu, memory, latency, requests."""
-    try:
-        project_id = project_id or os.getenv("GOOGLE_CLOUD_PROJECT")
-        credential = get_user_credentials(tool_context)
-        if not credential: return "Error: Authentication required."
-        client = monitoring_v3.MetricServiceClient(credentials=credential)
-        metrics_map = {
-            "cpu": "run.googleapis.com/container/cpu/utilizations",
-            "memory": "run.googleapis.com/container/memory/utilizations",
-            "latency": "run.googleapis.com/request_latencies",
-            "requests": "run.googleapis.com/request_count"
-        }
-        if metric_type not in metrics_map: return f"Error: Unknown metric {metric_type}"
-        now = time.time()
-        interval = monitoring_v3.TimeInterval({"end_time": {"seconds": int(now)}, "start_time": {"seconds": int(now) - (duration_minutes * 60)}})
-        filter_str = f'metric.type = "{metrics_map[metric_type]}" AND resource.labels.service_name = "{service_name}"'
-        aggregation = monitoring_v3.Aggregation({
-            "alignment_period": {"seconds": duration_minutes * 60},
-            "per_series_aligner": monitoring_v3.Aggregation.Aligner.ALIGN_PERCENTILE_99 if metric_type != "requests" else monitoring_v3.Aggregation.Aligner.ALIGN_SUM,
-            "cross_series_reducer": monitoring_v3.Aggregation.Reducer.REDUCE_MEAN if metric_type != "requests" else monitoring_v3.Aggregation.Reducer.REDUCE_SUM
-        })
-        results = []
-        page_result = client.list_time_series(request={"name": f"projects/{project_id}", "filter": filter_str, "interval": interval, "aggregation": aggregation})
-        for ts in page_result:
-            for point in ts.points:
-                val = point.value
-                val_str = f"{val.double_value:.4f}" if val.double_value else f"{val.int64_value}"
-                results.append(f"Metric: {metric_type.upper()}, Value: {val_str}")
-                break
-        return f"Metrics for {service_name}:\\n" + "\\n".join(results) if results else "No data found."
-    except Exception as e:
-        return f"Error getting service metrics: {e}"
-`;
-    }
-
-    if (config.enableResourceDiscovery) {
-        code += `
-import google.cloud.run_v2 as run_v2
-import google.cloud.resourcemanager_v3 as resourcemanager_v3
-
-def resolve_project_id(tool_context: ToolContext, name_or_id: str) -> str:
-    """Resolves a Project Name or ID to a Project ID."""
-    if " " in name_or_id or any(c.isupper() for c in name_or_id):
-        try:
-            credential = get_user_credentials(tool_context)
-            if not credential: return "Error: Authentication required."
-            client = resourcemanager_v3.ProjectsClient(credentials=credential)
-            request = resourcemanager_v3.SearchProjectsRequest(query=f"lifecycleState:ACTIVE AND displayName='{name_or_id}'")
-            page_result = client.search_projects(request=request)
-            for project in page_result: return project.project_id
-            return f"Error: No project found with display name '{name_or_id}'"
-        except Exception as e: return f"Error resolving project: {str(e)}"
-    return name_or_id
-
-def list_services(tool_context: ToolContext, project_id: str = None) -> str:
-    """List Cloud Run services in the configured project across ALL regions."""
-    try:
-        project_id = project_id or os.getenv("GOOGLE_CLOUD_PROJECT")
-        credential = get_user_credentials(tool_context)
-        if not credential: return "Error: Authentication required."
-        client = run_v2.ServicesClient(credentials=credential)
-        parent = f"projects/{project_id}/locations/-"
-        request = run_v2.ListServicesRequest(parent=parent)
-        page_result = client.list_services(request=request)
-        services = []
-        for service in page_result:
-            conditions = {c.type_: c.state for c in service.conditions}
-            succeeded = run_v2.Condition.State.CONDITION_SUCCEEDED
-            is_ready = False
-            if "Ready" in conditions: is_ready = (conditions["Ready"] == succeeded)
-            elif "RoutesReady" in conditions and "ConfigurationsReady" in conditions: is_ready = (conditions["RoutesReady"] == succeeded and conditions["ConfigurationsReady"] == succeeded)
-            status = "Ready" if is_ready else "Not Ready"
-            region = service.name.split('/')[3]
-            service_name = service.name.split('/')[-1]
-            services.append(f"- {service_name} ({region}): {status} ({service.uri})")
-        return "Cloud Run Services:\\n" + "\\n".join(services) if services else "No Cloud Run services found."
-    except Exception as e:
-        return f"Error listing Cloud Run services: {str(e)}"
-
-def list_projects(tool_context: ToolContext, filter_str: str = "lifecycleState:ACTIVE") -> str:
-    """List accessible Google Cloud projects."""
-    try:
-        credential = get_user_credentials(tool_context)
-        if not credential: return "Error: Authentication required."
-        client = resourcemanager_v3.ProjectsClient(credentials=credential)
-        request = resourcemanager_v3.SearchProjectsRequest(query=filter_str)
-        page_result = client.search_projects(request=request)
-        projects = [f"- {p.display_name} ({p.project_id})" for p in page_result]
-        return "Projects:\\n" + "\\n".join(projects) if projects else "No projects found."
-    except Exception as e:
-        return f"Error listing projects: {str(e)}"
-`;
-    }
-
-    if (config.enableSecurityCenter) {
-        code += `
-import google.cloud.securitycenter as securitycenter
-
-def list_active_findings(tool_context: ToolContext, category: str = None, project_id: str = None) -> str:
-    """Lists active, unmuted security findings for the project."""
-    try:
-        project_id = project_id or os.getenv("GOOGLE_CLOUD_PROJECT")
-        credential = get_user_credentials(tool_context)
-        if not credential: return "Error: Authentication required."
-        client = securitycenter.SecurityCenterClient(credentials=credential)
-        source_name = f"projects/{project_id}/sources/-"
-        filter_str = 'state="ACTIVE" AND mute="UNMUTED"'
-        if category: filter_str += f' AND category="{category}"'
-        req = securitycenter.ListFindingsRequest(parent=source_name, filter=filter_str, page_size=100)
-        findings_by_category = {}
-        count = 0
-        for result in client.list_findings(request=req):
-            finding = result.finding
-            cat = finding.category
-            resource = finding.resource_name
-            severity = finding.severity.name if hasattr(finding.severity, 'name') else str(finding.severity)
-            if cat not in findings_by_category: findings_by_category[cat] = []
-            findings_by_category[cat].append(f"[{severity}] {resource}")
-            count += 1
-            if count >= 20: break
-        if count == 0: return f"No active, unmuted security findings found for project {project_id}."
-        output_lines = [f"Active Security Findings for {project_id}:"]
-        for cat, items in findings_by_category.items():
-            output_lines.append(f"\\nCategory: {cat}")
-            for item in items: output_lines.append(f"  - {item}")
-        if count >= 20: output_lines.append("\\n(Output truncated)")
-        return "\\n".join(output_lines)
-    except Exception as e:
-        if "PermissionDenied" in str(e) or "disabled" in str(e).lower():
-            return f"Unable to list findings. Security Command Center might not be active or you lack permissions for project {project_id}."
-        return f"Error fetching security findings: {str(e)}"
-`;
-    }
-
-    if (config.enableRecommender) {
-        code += `
-import google.cloud.recommender_v1 as recommender_v1
-import google.cloud.run_v2 as run_v2
-
-def list_recommendations(tool_context: ToolContext, project_id: str = None) -> str:
-    """List active recommendations for Cloud Run services, focusing on security and identity."""
-    try:
-        project_id = project_id or os.getenv("GOOGLE_CLOUD_PROJECT")
-        credential = get_user_credentials(tool_context)
-        if not credential: return "Error: Authentication required."
-        regions = set()
-        try:
-            run_client = run_v2.ServicesClient(credentials=credential)
-            page_result = run_client.list_services(request=run_v2.ListServicesRequest(parent=f"projects/{project_id}/locations/-"))
-            for service in page_result:
-                parts = service.name.split("/")
-                if len(parts) > 3: regions.add(parts[3])
-        except Exception: pass
-        if not regions: regions.add(os.getenv("GOOGLE_CLOUD_LOCATION", "us-central1"))
-        recommender_client = recommender_v1.RecommenderClient(credentials=credential)
-        recommenders = ["google.run.service.IdentityRecommender", "google.run.service.SecurityRecommender"]
-        results = []
-        for location in regions:
-            for r_id in recommenders:
-                try:
-                    request = recommender_v1.ListRecommendationsRequest(parent=f"projects/{project_id}/locations/{location}/recommenders/{r_id}")
-                    for rec in recommender_client.list_recommendations(request=request):
-                        target_resource = "Unknown Resource"
-                        if rec.content and rec.content.overview:
-                            target_resource = rec.content.overview.get("serviceName") or rec.content.overview.get("service") or rec.content.overview.get("resourceName") or "Unknown Resource"
-                        if "/" in target_resource: target_resource = target_resource.split("/")[-1]
-                        results.append(f"- [{location}] {target_resource}: {rec.description} (Priority: {rec.priority.name})")
-                except Exception: pass
-        return "Active Cloud Run Recommendations:\\n" + "\\n".join(results) if results else "No active security or identity recommendations found for Cloud Run."
-    except Exception as e:
-        return f"Error listing recommendations: {str(e)}"
-
-def list_cost_recommendations(tool_context: ToolContext, project_id: str = None) -> str:
-    """List active cost recommendations for the project."""
-    try:
-        project_id = project_id or os.getenv("GOOGLE_CLOUD_PROJECT")
-        location = os.getenv("GOOGLE_CLOUD_LOCATION", "us-central1")
-        zones = [f"{location}-{suffix}" for suffix in ["a", "b", "c", "f"]]
-        credential = get_user_credentials(tool_context)
-        if not credential: return "Error: Authentication required."
-        recommender_client = recommender_v1.RecommenderClient(credentials=credential)
-        recommenders = [
-            "google.compute.instance.IdleResourceRecommender", 
-            "google.compute.instance.MachineTypeRecommender",
-            "google.compute.address.IdleResourceRecommender",
-            "google.compute.disk.IdleResourceRecommender"
-        ]
-        results = []
-        total_savings = 0.0
-        currency = "USD"
-        for zone in zones:
-            for r_id in recommenders:
-                try:
-                    request = recommender_v1.ListRecommendationsRequest(parent=f"projects/{project_id}/locations/{zone}/recommenders/{r_id}")
-                    for rec in recommender_client.list_recommendations(request=request):
-                        impact = 0.0
-                        if rec.primary_impact.cost_projection.cost.units: impact += float(rec.primary_impact.cost_projection.cost.units)
-                        if rec.primary_impact.cost_projection.cost.nanos: impact += float(rec.primary_impact.cost_projection.cost.nanos) / 1e9
-                        savings = -impact if impact < 0 else 0
-                        if savings > 0:
-                            total_savings += savings
-                            if rec.primary_impact.cost_projection.cost.currency_code: currency = rec.primary_impact.cost_projection.cost.currency_code
-                        target = "Unknown"
-                        if rec.content.overview:
-                             target = rec.content.overview.get("resourceName") or rec.content.overview.get("resource") or "Unknown"
-                        if "/" in target: target = target.split("/")[-1]
-                        results.append(f"- [{zone}] {target}: {rec.description} (Est. Savings: {savings:.2f} {currency}/mo)")
-                except Exception: pass
-        if not results: return f"No active cost recommendations found in {location} zones."
-        return f"Active Cost Recommendations (Total Est. Savings: {total_savings:.2f} {currency}/mo):\\n" + "\\n".join(results)
-    except Exception as e:
-        return f"Error listing cost recommendations: {str(e)}"
-`;
-    }
-
-    if (config.enableServiceHealth) {
-        code += `
-from google.cloud import servicehealth_v1
-
-def check_service_health(tool_context: ToolContext, project_id: str = None) -> str:
-    """Checks for active Google Cloud Service Health events affecting the project."""
-    try:
-        project_id = project_id or os.getenv("GOOGLE_CLOUD_PROJECT")
-        credential = get_user_credentials(tool_context)
-        if not credential: return "Error: Authentication required."
-        client = servicehealth_v1.ServiceHealthClient(credentials=credential)
-        parent = f"projects/{project_id}/locations/global"
-        request = servicehealth_v1.ListEventsRequest(parent=parent, filter='state="ACTIVE"')
-        results = [f"- [{e.category.name}][{e.state.name}] {e.title}: {e.description} (Updated: {e.update_time})" for e in client.list_events(request=request)]
-        return f"Active Service Health Events for {project_id}:\\n" + "\\n".join(results) if results else f"No active service health events found for project {project_id}."
-    except Exception as e:
-        return f"Error checking service health: {str(e)}"
-`;
-    }
-
-    if (config.enableNetworkManagement) {
-        code += `
-from google.cloud import network_management_v1
-
-def run_connectivity_test(tool_context: ToolContext, source_ip: str = None, source_network: str = None, destination_ip: str = None, destination_port: int = None, protocol: str = "TCP", project_id: str = None) -> str:
-    """Runs a network connectivity test."""
-    try:
-        project_id = project_id or os.getenv("GOOGLE_CLOUD_PROJECT")
-        credential = get_user_credentials(tool_context)
-        if not credential: return "Error: Authentication required."
-        client = network_management_v1.ReachabilityServiceClient(credentials=credential)
-        parent = f"projects/{project_id}/locations/global"
-        
-        endpoint_source = network_management_v1.Endpoint()
-        if source_ip: endpoint_source.ip_address = source_ip
-        if source_network: endpoint_source.network = source_network
-        
-        endpoint_destination = network_management_v1.Endpoint()
-        if destination_ip: endpoint_destination.ip_address = destination_ip
-        if destination_port: endpoint_destination.port = destination_port
-        
-        connectivity_test = network_management_v1.ConnectivityTest(
-            source=endpoint_source,
-            destination=endpoint_destination,
-            protocol=protocol
-        )
-        
-        request = network_management_v1.CreateConnectivityTestRequest(
-            parent=parent,
-            test_id="adk-temp-test",
-            connectivity_test=connectivity_test
-        )
-        # Note: Proper implementation requires polling the LRO, skipping full implementation for brevity.
-        return "Not fully implemented in template."
-    except Exception as e:
-        return f"Error running connectivity test: {str(e)}"
-`;
-    }
-
 
 
     if (config.enableBigQueryMcp) {
@@ -1121,39 +729,7 @@ def get_bigquery_mcp_toolset() -> McpToolset:
 `;
     }
 
-    if (config.enableEmailTool) {
-        code += `
-import smtplib
-from email.mime.text import MIMEText
-from email.mime.multipart import MIMEMultipart
-
-def send_email(tool_context: ToolContext, recipient: str, subject: str, html_body: str) -> str:
-    """Sends an HTML email."""
-    sender_email = os.getenv("SENDER_EMAIL")
-    smtp_server = os.getenv("SMTP_SERVER")
-    smtp_port = os.getenv("SMTP_PORT", 587)
-    smtp_user = os.getenv("SMTP_USER")
-    smtp_password = os.getenv("SMTP_PASSWORD")
 
-    if not all([sender_email, smtp_server, smtp_user, smtp_password]):
-        return "Error: Email configuration missing in environment."
-
-    try:
-        message = MIMEMultipart("alternative")
-        message["Subject"] = subject
-        message["From"] = sender_email
-        message["To"] = recipient
-        message.attach(MIMEText(html_body, "html"))
-
-        with smtplib.SMTP(smtp_server, int(smtp_port)) as server:
-            server.starttls()
-            server.login(smtp_user, smtp_password)
-            server.sendmail(sender_email, recipient, message.as_string())
-        return "Email sent successfully."
-    except Exception as e:
-        return f"Error sending email: {str(e)}"
-`;
-    }
 
     return code;
 };
@@ -1292,9 +868,6 @@ bq_logging_plugin = BigQueryAgentAnalyticsPlugin(
         'import os',
         'from dotenv import load_dotenv',
         agentImport,
-        'from dotenv import load_dotenv',
-        agentImport,
-        'from vertexai.preview import reasoning_engines',
         config.enableThinking ? 'from google.adk.planners import BuiltInPlanner' : '',
         config.enableThinking ? 'from google.genai import types as genai_types' : '',
         ...Array.from(toolImports),
@@ -1305,11 +878,6 @@ bq_logging_plugin = BigQueryAgentAnalyticsPlugin(
         imports.push(`from tools import ${Array.from(toolsImport).join(', ')}`);
     }
 
-    const hasPlugins = pluginList.length > 0;
-    if (hasPlugins) {
-        imports.push(adkAppImport);
-    }
-
     return `
 ${imports.join('\n')}
 
@@ -1332,7 +900,7 @@ thinking_planner = BuiltInPlanner(
 ` : ''}
 
 # Define the root agent
-root_agent = ${agentClass}(
+agent = ${agentClass}(
     name=${formatPythonString(config.name)},
     description=${formatPythonString(config.description)},
     model=os.getenv("MODEL", ${formatPythonString(modelName)}),
@@ -1340,64 +908,74 @@ root_agent = ${agentClass}(
     tools=[${toolListForAgent.join(', ')}],
     ${config.enableThinking ? 'planner=thinking_planner,' : ''}
 )
+`.trim();
+};
 
-${hasPlugins ? `
-# Define the ADK App with plugins
-adk_app = App(
-    name=${formatPythonString(config.name)},
-    root_agent=root_agent,
-    plugins=[${pluginList.join(', ')}],
-)
-` : ''}
+const generateAppPy = (): string => {
+    return `
+import asyncio
+try:
+    import nest_asyncio
+    nest_asyncio.apply()
+except ImportError:
+    pass
 
-${config.enableStreaming ? `
-# Streaming Wrapper
-from typing import Generator
+from agent import agent
 
-class StreamingAgentWrapper:
+class SyncAgentWrapper:
+    """
+    Wraps an async ADK Agent to provide a synchronous 'query' method.
+    Bypassing AdkApp and using this wrapper directly is the most reliable
+    way to ensure method registration on Vertex AI.
+    """
     def __init__(self, agent):
         self.agent = agent
-
-    def query(self, input: str, **kwargs) -> Generator[str, None, None]:
-        # Use the underlying model's start_chat and send_message with stream=True
-        # This bypasses the agent's query/run method to force streaming from the model
-        # Note: This is a simplification. For full agent features like tool use + streaming, 
-        # one would typically need a streaming-compatible runner or updated Agent class.
-        # This wrapper assumes direct model interaction for streaming as a fallback.
+        # Copy important attributes for SDK inspection and identification
+        if hasattr(agent, 'tools'):
+            self.tools = agent.tools
+        if hasattr(agent, 'py_class_name'):
+             self.py_class_name = agent.py_class_name
+
+    def query(self, input: str = "", message: str = "", **kwargs) -> str:
+        """
+        Synchronous entry point.
+        Accepts both 'input' and 'message' for maximum client compatibility.
+        """
+        query_text = message or input or ""
         
-        # If the agent has a model with start_chat, use it.
-        if hasattr(self.agent, 'model') and hasattr(self.agent.model, 'start_chat'):
-            chat = self.agent.model.start_chat()
-            response_stream = chat.send_message(input, stream=True, **kwargs)
-            for chunk in response_stream:
-                if chunk.text:
-                    yield chunk.text
+        # Prioritize run_async (modern ADK) then query
+        if hasattr(self.agent, 'run_async'):
+             return asyncio.run(self.agent.run_async(query_text, **kwargs))
+        elif hasattr(self.agent, 'query'):
+             if asyncio.iscoroutinefunction(self.agent.query):
+                 return asyncio.run(self.agent.query(query_text, **kwargs))
+             return self.agent.query(query_text, **kwargs)
         else:
-            # Fallback to non-streaming if model doesn't support it easily
-            yield self.agent.query(input, **kwargs)
-
-    def __getattr__(self, name):
-        return getattr(self.agent, name)
-` : ''}
-
-# Define the App for Vertex AI Agent Engine
-# Note: Root agent is wrapped in AdkApp as requested.
-# If streaming is enabled, wrap the agent.
-# Note: AdkApp expects 'agent' to have a 'query' method.
-final_agent = ${config.enableStreaming ? 'StreamingAgentWrapper(root_agent)' : 'root_agent'}
-${hasPlugins ? 'final_agent = adk_app' : ''} # Plugins take precedence if wrapping agent, but typically plug-ins wrap root_agent inside AdkApp logic.
-# Actually AdkApp takes 'agent'. If we use plugins, 'adk_app' IS the app. 
-# But 'reasoning_engines.AdkApp' wraps an agent. 
-# If we have plugins, 'adk_app' is an instance of 'google.adk.apps.App'.
-# Reasoning Engine's AdkApp expects a 'google.adk.agents.Agent' or compatible.
-
-app = reasoning_engines.AdkApp(
-    agent=${hasPlugins ? 'adk_app' : 'final_agent'},
-    enable_tracing=False
-)
+             raise AttributeError("Agent has no 'run_async' or 'query' method.")
+
+    def get_a2a_discovery_card(self) -> str:
+        """
+        Explicitly exposes the discovery card to the Reasoning Engine's public schema.
+        Required for Agent-to-Agent (A2A) discovery via the manager UI.
+        """
+        if hasattr(self.agent, 'get_a2a_discovery_card'):
+            return self.agent.get_a2a_discovery_card()
+
+        # Fallback to search in tools list
+        for tool in getattr(self.agent, 'tools', []):
+            if tool.__name__ == 'get_a2a_discovery_card':
+                return tool()
+        return "{}"
+
+# Wrap for deployment
+app = SyncAgentWrapper(agent)
 `.trim();
 };
 
+const generateInitPy = (): string => {
+    return ``;
+};
+
 const generateAdkDeployScript = (config: AdkAgentConfig): string => {
     return `
 import os
@@ -1416,23 +994,20 @@ logger.info(f"Initializing Vertex AI: project={project_id}, location={location},
 vertexai.init(project=project_id, location=location, staging_bucket=staging_bucket)
 
 try:
-    import agent
-    if hasattr(agent, 'app'):
+    import app
+    if hasattr(app, 'app'):
         # If the user defined an App, use it.
-        app_obj = agent.app
-        logger.info("Imported 'app' from agent.py")
+        app_obj = app.app
+        logger.info("Imported 'app' from app.py")
     else:
-        # Fallback to root_agent
-        logger.info("Imported 'root_agent' from agent.py")
-        app_obj = agent.root_agent
-        
-    logger.info("Agent imported successfully.")
+        logger.error("No 'app' variable found in app.py")
+        raise AttributeError("No 'app' variable")
 except ImportError as e:
-    logger.error(f"Failed to import agent: {e}")
+    logger.error(f"Failed to import app: {e}")
     raise
 
 # Read requirements
-reqs = ["google-cloud-aiplatform[adk,agent_engines]>=1.75.0", "google-adk>=0.1.0", "python-dotenv"]
+reqs = ["google-cloud-aiplatform[adk,agent_engines]>=1.75.0", "google-adk>=0.1.0", "python-dotenv", "nest_asyncio"]
 if os.path.exists("requirements.txt"):
     with open("requirements.txt", "r") as f:
         for line in f:
@@ -1477,25 +1052,9 @@ if os.path.exists(".env"):
     except Exception as e:
         logger.warning(f"Failed to parse .env file: {e}")
 
-# --- CRITICAL FIX FOR Pydantic ValidationError ---
-# We check if the app_obj is already an AdkApp instance by checking key attributes or class name.
-# This prevents 'double-wrapping' which causes the 'Input should be a valid dictionary or instance of BaseAgent' error.
-is_already_adk_app = (
-    hasattr(app_obj, 'agent') or
-    hasattr(app_obj, '_agent') or
-    app_obj.__class__.__name__ == 'AdkApp'
-)
-
-if is_already_adk_app:
-     app_to_deploy = app_obj
-     logger.info(f"App is already an AdkApp instance ({type(app_obj).__name__}). Proceeding to deploy...")
-else:
-     logger.info("Wrapping agent in AdkApp for deployment...")
-     app_to_deploy = reasoning_engines.AdkApp(agent=app_obj, enable_tracing=False)
-
 logger.info("Creating Agent Engine...")
 
-# Detect extra packages (like auth_utils.py)
+# Detect extra packages
 extra_packages = []
 for f in os.listdir("."):
     if f in ["deploy_re.py", ".env", "requirements.txt", ".git", ".adk", "venv", ".venv", "__pycache__", "node_modules"]:
@@ -1522,113 +1081,73 @@ print(f"Resource Name: {remote_app.resource_name}")
 };
 
 const generateAdkEnvFile = (config: AdkAgentConfig, projectNumber: string, location: string, stagingBucket: string): string => {
-    let content = `GOOGLE_GENAI_USE_VERTEXAI=TRUE
-MODEL="${config.model}"
-GOOGLE_CLOUD_PROJECT="${projectNumber}"
-GOOGLE_CLOUD_LOCATION="${location}"
-STAGING_BUCKET="${stagingBucket || 'gs://YOUR_BUCKET_NAME'}"
-AGENT_DISPLAY_NAME="${config.name}"`;
-
-    if (config.enableOAuth && config.authId) {
-        content += `\nAUTH_ID="${config.authId}"`;
-    }
-    
-
-    
+    let env = `GOOGLE_CLOUD_PROJECT=${projectNumber}
+GOOGLE_CLOUD_LOCATION=${location}
+STAGING_BUCKET=${stagingBucket}`;
 
     if (config.enableDiscoveryApi) {
-        content += `
-DISCOVERY_ENGINE_PROJECT_ID="${config.discoveryConfig.projectId}"
-DISCOVERY_ENGINE_LOCATION="${config.discoveryConfig.location}"
-DISCOVERY_ENGINE_COLLECTION="${config.discoveryConfig.collection}"
-DISCOVERY_ENGINE_ENGINE_ID="${config.discoveryConfig.engineId}"
-DISCOVERY_ENGINE_DATA_STORE_IDS="${config.discoveryConfig.dataStoreIds}"`;
+        env += `
+
+# Discovery Engine
+DISCOVERY_ENGINE_PROJECT_ID=${config.discoveryConfig.projectId || projectNumber}
+DISCOVERY_ENGINE_LOCATION=${config.discoveryConfig.location || 'global'}
+DISCOVERY_ENGINE_COLLECTION=${config.discoveryConfig.collection || 'default_collection'}
+DISCOVERY_ENGINE_ENGINE_ID=${config.discoveryConfig.engineId || 'your-engine-id'}
+DISCOVERY_ENGINE_DATA_STORE_IDS=${config.discoveryConfig.dataStoreIds || ''}`;
     }
 
-    if (config.enableTelemetry) {
-        content += `\nGOOGLE_CLOUD_AGENT_ENGINE_ENABLE_TELEMETRY=true`;
-    }
-    if (config.enableMessageLogging) {
-        content += `\nOTEL_INSTRUMENTATION_GENAI_CAPTURE_MESSAGE_CONTENT=true`;
+    if (config.enableBigQueryMcp) {
+        env += `
+
+# BigQuery
+BQ_USER_PROJECT=${projectNumber}`;
     }
 
-    return content.trim();
+    return env;
 };
 
 const generateAdkRequirementsFile = (config: AdkAgentConfig): string => {
-    const requirements = new Set([
-        'google-cloud-aiplatform[adk,agent_engines]>=1.75.0', 
-        'python-dotenv',
-        'google-adk>=0.1.0'
-    ]);
-    if (config.enableOAuth || config.tools.some(t => t.type === 'A2AClientTool')) {
-        requirements.add('google-auth-oauthlib>=1.2.2');
-        requirements.add('google-api-python-client');
-        requirements.add('google-auth');
-    }
-
-    if (config.tools.some(t => t.type === 'A2AClientTool') || config.enableDiscoveryApi) {
-        requirements.add('requests');
-    }
-
-    if (config.enableCloudLogging) {
-        requirements.add('google-cloud-logging');
-    }
-    if (config.enableCloudStorage) {
-        requirements.add('google-cloud-storage');
-    }
+    const defaultDeps = [
+        "google-adk>=0.1.0",
+        "google-cloud-aiplatform[adk,agent_engines]>=1.75.0",
+        "python-dotenv",
+        "nest_asyncio",
+        "google-auth",
+        "requests"
+    ];
 
-    if (config.enableMonitoring) {
-        requirements.add('google-cloud-monitoring');
-    }
-    if (config.enableResourceDiscovery) {
-        requirements.add('google-cloud-run');
-        requirements.add('google-cloud-resource-manager>=1.0.0');
-    }
-    if (config.enableSecurityCenter) {
-        requirements.add('google-cloud-securitycenter');
-    }
-    if (config.enableRecommender) {
-        requirements.add('google-cloud-recommender');
-        requirements.add('google-cloud-run'); // Also uses run client
-    }
-    if (config.enableServiceHealth) {
-        requirements.add('google-cloud-servicehealth>=0.1.0');
-    }
-    if (config.enableNetworkManagement) {
-        requirements.add('google-cloud-network-management>=1.0.0');
+    if (config.enableBigQueryMcp) {
+        defaultDeps.push("google-cloud-bigquery");
     }
 
+    // A2A clients usually need requests or aiohttp, already got requests.
 
-    return Array.from(requirements).join('\n');
+    return defaultDeps.join('\n');
 };
 
 const generateAdkReadmeFile = (config: AdkAgentConfig): string => {
-    return `
-# Agent Quickstart
-
-This agent was created using the Gemini Enterprise Manager Agent Builder (ADK).
+    return `# ${config.name || 'Custom Agent' }
+
+## Setup
+    1. Create a virtual environment: \`python3 -m venv venv && source venv/bin/activate\`
+2. Install dependencies: \`pip install -r requirements.txt\`
+3. Set environment variables in \`.env\`.
+
+## Files
+- \`app.py\`: The asynchronous sync wrapper and deployment entrypoint.
+- \`agent.py\`: Defines the agent instruction, model, and tool bindings.
+- \`.env\`: Local environment variables.
+- \`requirements.txt\`: Python dependencies.
+- \`auth.py\`: Common authentication utilities (if needed).
+- \`tools.py\`: Tool definitions.
+- \`__init__.py\`: Empty init file.
 
 ## Deployment
-
-1.  **Install ADK:**
-    \`\`\`sh
-    pip install "google-cloud-aiplatform[adk,agent_engines]>=1.75.0"
-    \`\`\`
-
-2.  **Install dependencies:**
-    \`\`\`sh
-    pip install -r requirements.txt
-    \`\`\`
-
-3.  **Deploy to Vertex AI:**
-    Ensure you have set \`GOOGLE_CLOUD_PROJECT\`, \`GOOGLE_CLOUD_LOCATION\`, and \`STAGING_BUCKET\` in your \`.env\` file.
-    
-    Run the deploy script:
-    \`\`\`sh
-    python deploy_re.py
-    \`\`\`
-`.trim();
+Run the deployment script to deploy the agent to Vertex AI Agent Engine:
+\`\`\`bash
+python deploy_re.py
+\`\`\`
+`;
 };
 
 
@@ -1649,11 +1168,6 @@ const GCP_LOGS_READER_TEMPLATE: AgentTemplate = {
         model: 'gemini-2.5-flash',
         instruction: 'You are a Google Cloud Logging expert. Your goal is to help users find and analyze logs from their GCP projects. You have access to tools for reading logs and searching Google. Always verify the project ID before querying.',
         useGoogleSearch: true,
-        enableOAuth: true,
-        authId: 'default',
-        enableCloudLogging: true,
-        enableTelemetry: true,
-        enableMessageLogging: true,
         tools: []
     }
 };
@@ -1683,18 +1197,7 @@ Report formatting guidelines:
 * For lists of findings or resources, use bullet points.
 * Always cite the exact project ID and environment details where you found the information.`,
         useGoogleSearch: true,
-        enableOAuth: true,
-        authId: 'default',
-        enableCloudLogging: true,
-        enableTelemetry: true,
-        enableMonitoring: true,
-        enableSecurityCenter: true,
-        enableRecommender: true,
-        enableServiceHealth: true,
-        enableNetworkManagement: true,
-        enableResourceDiscovery: true,
         enableBigQueryMcp: false,
-        enableEmailTool: false,
         tools: []
     }
 };
@@ -1721,18 +1224,7 @@ Report formatting guidelines:
 * Always explain your SQL logic briefly.
 * Present query results in clear markdown tables if possible.`,
         useGoogleSearch: true,
-        enableOAuth: true,
-        authId: 'default',
-        enableCloudLogging: true,
-        enableTelemetry: true,
-        enableMonitoring: false,
-        enableSecurityCenter: false,
-        enableRecommender: false,
-        enableServiceHealth: false,
-        enableNetworkManagement: false,
-        enableResourceDiscovery: false,
         enableBigQueryMcp: true,
-        enableEmailTool: false,
         tools: []
     }
 };
@@ -1792,8 +1284,6 @@ const AgentBuilderPage: React.FC<AgentBuilderPageProps> = ({ projectNumber, setP
         instruction: 'You are an awesome and helpful agent.',
         tools: [],
         useGoogleSearch: false,
-        enableOAuth: false,
-        authId: '',
         enableDiscoveryApi: false,
         discoveryConfig: {
             projectId: '',
@@ -1802,28 +1292,17 @@ const AgentBuilderPage: React.FC<AgentBuilderPageProps> = ({ projectNumber, setP
             engineId: '',
             dataStoreIds: ''
         },
-        enableCloudLogging: false,
-        enableCloudStorage: false,
-        enableTelemetry: false,
-        enableMessageLogging: false,
         enableBqAnalytics: false,
         bqDatasetId: '',
         bqTableId: '',
         enableThinking: false,
         thinkingBudget: 1024,
         enableStreaming: false,
-        enableMonitoring: false,
-        enableSecurityCenter: false,
-        enableRecommender: false,
-        enableServiceHealth: false,
-        enableNetworkManagement: false,
-        enableResourceDiscovery: false,
-        enableBigQueryMcp: false,
-        enableEmailTool: false
+        enableBigQueryMcp: false
     });
     const [vertexLocation, setVertexLocation] = useState('us-central1');
-    const [adkGeneratedCode, setAdkGeneratedCode] = useState({ agent: '', env: '', requirements: '', readme: '', deploy_re: '', auth_utils: '', tools: '' });
-    const [adkActiveTab, setAdkActiveTab] = useState<'agent' | 'env' | 'requirements' | 'readme' | 'deploy_re' | 'auth_utils' | 'tools'>('agent');
+    const [adkGeneratedCode, setAdkGeneratedCode] = useState({ app: '', agent: '', env: '', requirements: '', readme: '', deploy_re: '', auth: '', tools: '', init: '' });
+    const [adkActiveTab, setAdkActiveTab] = useState<'app' | 'agent' | 'env' | 'requirements' | 'readme' | 'deploy_re' | 'auth' | 'tools' | 'init'>('app');
     const [adkCopySuccess, setAdkCopySuccess] = useState('');
 
     // Discovery Engine State
@@ -1963,9 +1442,10 @@ const AgentBuilderPage: React.FC<AgentBuilderPageProps> = ({ projectNumber, setP
         const reqsCode = generateAdkRequirementsFile(adkConfig);
         const readmeCode = generateAdkReadmeFile(adkConfig);
         const deployCode = generateAdkDeployScript(adkConfig);
-        const authUtilsCode = generateAuthUtils();
+        const authCode = generateAuthPy();
         const toolsCode = generateToolsPy(adkConfig);
-        setAdkGeneratedCode({ agent: agentCode, env: envCode, requirements: reqsCode, readme: readmeCode, deploy_re: deployCode, auth_utils: authUtilsCode, tools: toolsCode });
+        const initCode = generateInitPy();
+        setAdkGeneratedCode({ app: generateAppPy(), agent: agentCode, env: envCode, requirements: reqsCode, readme: readmeCode, deploy_re: deployCode, auth: authCode, tools: toolsCode, init: initCode });
     }, [adkConfig, projectNumber, vertexLocation, stagingBucket]);
 
     // ADK Data Store & Buckets Fetching
@@ -2035,7 +1515,6 @@ const AgentBuilderPage: React.FC<AgentBuilderPageProps> = ({ projectNumber, setP
           try {
               // We need to resolve the project string first if currently a number, 
               // but here we just try api.listBuckets which likely expects an ID string or number.
-              // If projectNumber is actually a number, listBuckets usually works if valid.
               // Best effort:
               const b = await api.listBuckets(projectNumber);
               const items = b.items || [];
@@ -2157,36 +1636,32 @@ const AgentBuilderPage: React.FC<AgentBuilderPageProps> = ({ projectNumber, setP
         URL.revokeObjectURL(url);
     };
 
-    const handleDownloadAdk = async () => {
+    const handleDownloadAdkZip = () => {
         const zip = new JSZip();
-        zip.file('agent.py', adkGeneratedCode.agent);
-        zip.file('.env', adkGeneratedCode.env);
-        zip.file('requirements.txt', adkGeneratedCode.requirements);
-        zip.file('README.md', adkGeneratedCode.readme);
-        zip.file('deploy_re.py', adkGeneratedCode.deploy_re);
-        if (adkConfig.enableOAuth) {
-            zip.file('auth_utils.py', adkGeneratedCode.auth_utils);
-        }
-        zip.file('tools.py', adkGeneratedCode.tools);
-        const blob = await zip.generateAsync({ type: 'blob' });
-        const url = URL.createObjectURL(blob);
-        const a = document.createElement('a');
-        a.href = url;
-        a.download = `${adkConfig.name || 'agent'}-source.zip`;
-        document.body.appendChild(a);
-        a.click();
-        document.body.removeChild(a);
-        URL.revokeObjectURL(url);
+        zip.file("app.py", adkGeneratedCode.app);
+        zip.file("agent.py", adkGeneratedCode.agent);
+        zip.file(".env", adkGeneratedCode.env);
+        zip.file("requirements.txt", adkGeneratedCode.requirements);
+        zip.file("auth.py", adkGeneratedCode.auth);
+        zip.file("tools.py", adkGeneratedCode.tools);
+        zip.file("__init__.py", adkGeneratedCode.init);
+        zip.file("deploy_re.py", generateAdkDeployScript(adkConfig));
+        zip.file("README.md", generateAdkReadmeFile(adkConfig));
+
+        zip.generateAsync({ type: "blob" })
+            .then(function (content) {
+                saveAs(content, `${adkConfig.name || 'adk_agent'}.zip`);
+            });
     };
 
     const adkCodeDisplay = { 
+        app: adkGeneratedCode.app,
         agent: adkGeneratedCode.agent, 
         env: adkGeneratedCode.env, 
         requirements: adkGeneratedCode.requirements, 
-        readme: adkGeneratedCode.readme,
-        deploy_re: adkGeneratedCode.deploy_re,
-        auth_utils: adkGeneratedCode.auth_utils,
-        tools: adkGeneratedCode.tools
+        auth: adkGeneratedCode.auth,
+        tools: adkGeneratedCode.tools,
+        init: adkGeneratedCode.init
     }[adkActiveTab];
 
     const a2aCodeDisplay = { 
@@ -2197,18 +1672,15 @@ const AgentBuilderPage: React.FC<AgentBuilderPageProps> = ({ projectNumber, setP
     }[a2aActiveTab];
 
     const adkFilesForBuild = [
+        { name: 'app.py', content: adkGeneratedCode.app },
         { name: 'agent.py', content: adkGeneratedCode.agent },
         { name: '.env', content: adkGeneratedCode.env },
         { name: 'requirements.txt', content: adkGeneratedCode.requirements },
-        { name: 'README.md', content: adkGeneratedCode.readme },
-        { name: 'deploy_re.py', content: adkGeneratedCode.deploy_re },
-        { name: 'tools.py', content: adkGeneratedCode.tools }
+        { name: 'auth.py', content: adkGeneratedCode.auth },
+        { name: 'tools.py', content: adkGeneratedCode.tools },
+        { name: '__init__.py', content: adkGeneratedCode.init }
     ];
 
-    if (adkConfig.enableOAuth) {
-        adkFilesForBuild.push({ name: 'auth_utils.py', content: adkGeneratedCode.auth_utils });
-    }
-
     const a2aFilesForBuild = [
         { name: 'main.py', content: a2aGeneratedCode.main },
         { name: 'Dockerfile', content: a2aGeneratedCode.dockerfile },
@@ -2223,6 +1695,23 @@ const AgentBuilderPage: React.FC<AgentBuilderPageProps> = ({ projectNumber, setP
         setIsAdkDeployModalOpen(false);
     };
 
+    const ADK_TABS = [
+        { id: 'app', label: 'app.py' },
+        { id: 'agent', label: 'agent.py' },
+        { id: 'env', label: '.env' },
+        { id: 'requirements', label: 'requirements.txt' },
+        { id: 'auth', label: 'auth.py' },
+        { id: 'tools', label: 'tools.py' },
+        { id: 'init', label: '__init__.py' },
+    ];
+
+    const A2A_TABS = [
+        { id: 'main', label: 'main.py' },
+        { id: 'dockerfile', label: 'Dockerfile' },
+        { id: 'requirements', label: 'requirements.txt' },
+        { id: 'env', label: 'env.yaml' },
+    ];
+
     return (
         <div className="space-y-6 flex flex-col lg:h-full">
             <div className="flex justify-between items-center shrink-0">
@@ -2346,19 +1835,6 @@ const AgentBuilderPage: React.FC<AgentBuilderPageProps> = ({ projectNumber, setP
                                 </div>
                                 <div className="space-y-2 pt-2 border-t border-gray-600">
                                     <label className="flex items-center space-x-3 cursor-pointer"><input type="checkbox" name="useGoogleSearch" checked={adkConfig.useGoogleSearch} onChange={handleAdkConfigChange} className="h-4 w-4 bg-gray-700 border-gray-600 rounded" /><span className="text-sm text-gray-300">Enable Google Search Tool</span></label>
-                                    <label className="flex items-center space-x-3 cursor-pointer"><input type="checkbox" name="enableOAuth" checked={adkConfig.enableOAuth} onChange={handleAdkConfigChange} className="h-4 w-4 bg-gray-700 border-gray-600 rounded" /><span className="text-sm text-gray-300">Enable OAuth (For Reference)</span></label>
-                                    {adkConfig.enableOAuth && (
-                                        <div className="pl-7 space-y-2">
-                                            <input type="text" name="authId" value={adkConfig.authId} onChange={handleAdkConfigChange} placeholder="Authorization Resource ID" className="bg-gray-700 border border-gray-600 rounded-md px-2 py-1 text-xs text-gray-200 w-full" />
-
-
-                                            <label className="flex items-center space-x-3 cursor-pointer mt-2">
-                                                <input type="checkbox" name="enableDiscoveryApi" checked={adkConfig.enableDiscoveryApi} onChange={handleAdkConfigChange} className="h-4 w-4 bg-gray-700 border-gray-600 rounded" disabled />
-                                                <span className="text-sm text-gray-500 line-through">Enable Discovery Engine API (Disabled)</span>
-                                            </label>
-
-                                        </div>
-                                    )}
 
                                             <div className="pt-2 border-t border-gray-600 mt-2 space-y-2">
                                         <h4 className="text-xs font-semibold text-gray-400">Agent Capabilities</h4>
@@ -2388,41 +1864,11 @@ const AgentBuilderPage: React.FC<AgentBuilderPageProps> = ({ projectNumber, setP
                                     </div>
 
                                     <div className="pt-2 border-t border-gray-600 mt-2 space-y-2">
-                                        <h4 className="text-xs font-semibold text-gray-400">GCP Integrations (Tools)</h4>
-                                        <label className="flex items-center space-x-3 cursor-pointer">
-                                            <input type="checkbox" name="enableMonitoring" checked={adkConfig.enableMonitoring} onChange={handleAdkConfigChange} className="h-4 w-4 bg-gray-700 border-gray-600 rounded" />
-                                            <span className="text-sm text-gray-300">Cloud Monitoring & Metrics</span>
-                                        </label>
-                                        <label className="flex items-center space-x-3 cursor-pointer">
-                                            <input type="checkbox" name="enableResourceDiscovery" checked={adkConfig.enableResourceDiscovery} onChange={handleAdkConfigChange} className="h-4 w-4 bg-gray-700 border-gray-600 rounded" />
-                                            <span className="text-sm text-gray-300">Resource Discovery (Projects, Cloud Run)</span>
-                                        </label>
-                                        <label className="flex items-center space-x-3 cursor-pointer">
-                                            <input type="checkbox" name="enableSecurityCenter" checked={adkConfig.enableSecurityCenter} onChange={handleAdkConfigChange} className="h-4 w-4 bg-gray-700 border-gray-600 rounded" />
-                                            <span className="text-sm text-gray-300">Security Command Center Findings</span>
-                                        </label>
-                                        <label className="flex items-center space-x-3 cursor-pointer">
-                                            <input type="checkbox" name="enableRecommender" checked={adkConfig.enableRecommender} onChange={handleAdkConfigChange} className="h-4 w-4 bg-gray-700 border-gray-600 rounded" />
-                                            <span className="text-sm text-gray-300">Recommender (Security, Identity, Cost)</span>
-                                        </label>
-                                        <label className="flex items-center space-x-3 cursor-pointer">
-                                            <input type="checkbox" name="enableServiceHealth" checked={adkConfig.enableServiceHealth} onChange={handleAdkConfigChange} className="h-4 w-4 bg-gray-700 border-gray-600 rounded" />
-                                            <span className="text-sm text-gray-300">Google Cloud Service Health Events</span>
-                                        </label>
-                                        <label className="flex items-center space-x-3 cursor-pointer">
-                                            <input type="checkbox" name="enableNetworkManagement" checked={adkConfig.enableNetworkManagement} onChange={handleAdkConfigChange} className="h-4 w-4 bg-gray-700 border-gray-600 rounded" />
-                                            <span className="text-sm text-gray-300">Network Connectivity Tests</span>
-                                        </label>
-
+                                        <h4 className="text-xs font-semibold text-gray-400">Integrations (Tools)</h4>
                                         <label className="flex items-center space-x-3 cursor-pointer">
                                             <input type="checkbox" name="enableBigQueryMcp" checked={adkConfig.enableBigQueryMcp} onChange={handleAdkConfigChange} className="h-4 w-4 bg-gray-700 border-gray-600 rounded" />
                                             <span className="text-sm text-gray-300">BigQuery Managed MCP</span>
                                         </label>
-
-                                        <label className="flex items-center space-x-3 cursor-pointer">
-                                            <input type="checkbox" name="enableEmailTool" checked={adkConfig.enableEmailTool} onChange={handleAdkConfigChange} className="h-4 w-4 bg-gray-700 border-gray-600 rounded" />
-                                            <span className="text-sm text-gray-300">Email Notifications (SMTP)</span>
-                                        </label>
                                     </div>
 
                                     <div className="pt-2 border-t border-gray-600 mt-2 space-y-2">
@@ -2488,8 +1934,8 @@ const AgentBuilderPage: React.FC<AgentBuilderPageProps> = ({ projectNumber, setP
                                             className="bg-gray-600 border border-gray-500 rounded-md px-2 py-1 text-xs text-white w-full placeholder-gray-400 focus:outline-none focus:border-blue-500"
                                         />
                                         <div className="flex gap-2">
-                                            <select 
-                                                value={toolBuilderConfig.dataStoreId} 
+                                            <select
+                                                value={toolBuilderConfig.dataStoreId}
                                                 onChange={(e) => setToolBuilderConfig({...toolBuilderConfig, dataStoreId: e.target.value})}
                                                 className="bg-gray-600 border border-gray-500 rounded-md px-2 py-1 text-xs text-white w-full"
                                                 disabled={isLoadingDataStores}
@@ -2503,7 +1949,7 @@ const AgentBuilderPage: React.FC<AgentBuilderPageProps> = ({ projectNumber, setP
                                                     })
                                                 }
                                             </select>
-                                            <button 
+                                            <button
                                                 onClick={() => handleAddTool({ type: 'VertexAiSearchTool', dataStoreId: toolBuilderConfig.dataStoreId, variableName: `search_tool_${(builderTab === 'a2a' ? a2aConfig.tools : adkConfig.tools).length + 1}` })}
                                                 disabled={!toolBuilderConfig.dataStoreId}
                                                 className="px-2 py-1 bg-teal-600 text-white text-xs rounded hover:bg-teal-700 disabled:opacity-50"
@@ -2524,8 +1970,8 @@ const AgentBuilderPage: React.FC<AgentBuilderPageProps> = ({ projectNumber, setP
                                             className="bg-gray-600 border border-gray-500 rounded-md px-2 py-1 text-xs text-white w-full placeholder-gray-400 focus:outline-none focus:border-blue-500"
                                         />
                                         <div className="flex gap-2">
-                                            <select 
-                                                value={selectedA2aService} 
+                                            <select
+                                                value={selectedA2aService}
                                                 onChange={(e) => setSelectedA2aService(e.target.value)}
                                                 className="bg-gray-600 border border-gray-500 rounded-md px-2 py-1 text-xs text-white w-full"
                                                 disabled={isLoadingServices}
@@ -2630,8 +2076,8 @@ const AgentBuilderPage: React.FC<AgentBuilderPageProps> = ({ projectNumber, setP
                                         </button>
                                     </div>
                                 </div>
-                                <div className="bg-black rounded-md overflow-y-auto flex-1 min-h-0 border border-gray-800">
-                                    <pre className="p-3 text-xs text-gray-300 whitespace-pre-wrap font-mono"><code>{builderTab === 'adk' ? adkGeneratedCode.readme : a2aGeneratedCode.gcloud}</code></pre>
+                                <div className="bg-black rounded-md flex-1 min-h-0 border border-gray-800 flex items-center justify-center p-4">
+                                    <p className="text-sm text-gray-400 text-center">Export as .zip for manual inspection or deployment.</p>
                                 </div>
                             </div>
                         </div>
